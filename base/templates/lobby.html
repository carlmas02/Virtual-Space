{% extends 'main.html'%}
{% load static %}

{% block content  %}

<div class="body" background="{% static 'assets/bg.png' %}">
    <div class="tri"></div>

    <div class="ic">
      <div class="action-btn">
        <i class="fa fa-info-circle" aria-hidden="true"></i>
        <i class="fa fa-comments-o" aria-hidden="true"></i>
        <i class="fa fa-cog" aria-hidden="true"></i>
      </div>
    </div>

    <div class="logo">
      <img src="{% static 'assets/LOGO.png' %}" />
      <span class="help-text"> VirtualSpace </span>
    </div>
    <div class="lbg"></div>

    <div class="main">
      <div class="border">
        <form method = "POST" id = 'form' >
        <input
          type="text"
          class="input-field"
          name = "room"
          placeholder="Type in Code"
          required
        />
        <input type="submit" value = 'join meet' class="join"><b>Join Room</b></button>
          </form>
      </div>
    </div>

   
</div> 
<script type="text/javascript">
	
	let form = document.getElementById('form');


	let handleSubmit = async (e) =>{

		e.preventDefault();

		let room = e.target.room.value ;

		let response = await fetch(`/validate-room/?channel=${room}`);

		let data = await response.json();

    console.log(data)

		// if(data.response=='success'){
		// 	let response = await fetch(`/get-token/?channel=${room}`)
		// 	let data = await response.json()

		// 	let UID = data.uid
		// 	let token = data.token

		// 	console.log(data)

		// 	sessionStorage.setItem('UID',UID)
		// 	sessionStorage.setItem('token',token)
		// 	sessionStorage.setItem('room',room)

		// 	window.open('/room/','_self')

		// }
		// else {
		// 	text = document.getElementById('text')
		// 	text.innerHTML = 'no room access'
		// }

	}

	form.addEventListener('submit',handleSubmit);

</script>
{% endblock content %} 